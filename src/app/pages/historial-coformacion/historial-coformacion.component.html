<!-- Loading indicator -->
<div *ngIf="isLoading" class="loading-container">
    <p>Cargando historial de procesos de coformación...</p>
</div>

<!-- Error message -->
<div *ngIf="error" class="error-container">
    <p>{{ error }}</p>
    <button (click)="refreshData()">Reintentar</button>
</div>

<div class="history-container" *ngIf="!isLoading && !error">
    <div class="header-section">
        <h1>Historial de Procesos de Coformación</h1>
        <div class="button-group">
            <button class="back-button" *ngIf="vieneDelFormulario" (click)="volverAlFormulario()">
                Volver al Formulario
            </button>
            <button class="back-button" *ngIf="!vieneDelFormulario" (click)="volverAlPerfil()">
                Volver al Perfil
            </button>
        </div>
    </div>

    <!-- Empty state -->
    <div *ngIf="procesos.length === 0" class="empty-state">
        <p>No hay procesos de coformación registrados.</p>
    </div>

    <!-- Processes List -->
    <div *ngIf="procesos.length > 0" class="procesos-list">
        <div class="procesos-grid">
            <div *ngFor="let proceso of procesos" class="proceso-card">
                <div class="proceso-header">
                    <h3>Proceso #{{ proceso.proceso_id }}</h3>
                    <span class="estado-badge" [class.estado-pendiente]="proceso.estado_nombre === 'Pendiente'"
                          [class.estado-en-curso]="proceso.estado_nombre === 'En Curso'"
                          [class.estado-finalizado]="proceso.estado_nombre === 'Finalizado'">
                        {{ proceso.estado_nombre }}
                    </span>
                </div>

                <div class="proceso-body">
                    <div class="info-item">
                        <span class="label">Estudiante:</span>
                        <span class="value">{{ proceso.estudiante_nombre }}</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Empresa:</span>
                        <span class="value">{{ proceso.empresa_nombre }}</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Fecha Inicio:</span>
                        <span class="value">{{ proceso.fecha_inicio | date:'dd/MM/yyyy' }}</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Fecha Fin:</span>
                        <span class="value">
                            {{ proceso.fecha_fin ? (proceso.fecha_fin | date:'dd/MM/yyyy') : 'En curso' }}
                        </span>
                    </div>
                    <div class="info-item" *ngIf="proceso.observaciones">
                        <span class="label">Observaciones:</span>
                        <span class="value">{{ proceso.observaciones }}</span>
                    </div>
                </div>

                <div class="proceso-actions">
                    <button class="edit-btn" (click)="editarProceso(proceso.proceso_id)">
                        Editar Proceso
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
